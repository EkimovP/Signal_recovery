<h1 align="center">Восстановление сигнала из свертки</h1>

<img src="https://github.com/EkimovP/Signal_recovery/assets/125445428/237d15d6-f356-44f4-bded-58ebc4ced11d" align="right" width=500>

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Данный проект предназначен для исследования итерационного алгоритма восстановления.

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;В программе можно изобразить гауссовы купола, задав их параметры, или загрузить изображение.
После чего необходимо построить аппаратную функцию (ядро). 
Затем строится спектр исходного изображения и аппаратной функции с помощью метода 
быстрого преобразования Фурье (БПФ) и происходит свертка сигнала и фильтра, как процесс перемножения их
спектров. Затем можно добавить шум к свертке. После чего идет процесс восстановления.
<br> 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Рассчитывается параметр восстановления, который позволяет оценить работу метода и сравнить исходное и 
восстановленное изображения.
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Проводится исследование зависимости параметра восстановления от заданного диапазона шума.

***Алгоритм программы:***

1. **Ввод данных:** генерация гауссовых куполов или загрузка изображения. 
Так как используется БПФ, то необходимо брать исходное изображение *степени двойки*.
2. **Построение аппаратной функции (ядра).** 
3. **Построение спектров исходного изображения и аппаратной функции.**
4. **Свертка исходного изображения с аппаратной функцией.**
5. **Добавление шума к свертке.**
6. **Восстановление изображения с помощью итерационного алгоритма.**
7. **Расчет параметра восстановления.**
8. **Исследование зависимости параметра восстановления от шума.**

<h2 align="left">1. Входные и выходные данные</h2>

**Входные данные:** 
1. Гауссовых купола, которые можно сгенерировать по заданным параметрам;
2. Изображение.

**Выходные данные:** восстановленное изображение.

<h2 align="left">2. Описание логической структуры</h2>

1. Ввод данных. Генерация гауссовых куполов / загрузка изображения, перевод в оттенки серого. Построение аппаратной функции (ядра).
2. Отображение модуля спектра исходного изображения и аппаратной функции.
   1. Берется фурье преобразование по строкам.
   2. Транспонируется.
   3. Берется фурье по строкам.
   4. Транспонируется. Производится двухмерное фурье преобразование с получением спектра.
   5. Считается модуль.
   6. Разбивается изображение по половикам по горизонтали и вертикали.
   7. Полученные половинки меняются крест на крест.
3. Свертка исходного изображения с аппаратной функцией. Перемножаются спектры исходного изображения и аппаратной функции.
4. Добавление шума к свертке.
   1. Создание матрицы размером изображения.
   2. Значение каждого пикселя равно среднему по 12 случайным числам от 0 до 1 (нормальное распределение по Гауссу).
   3. Расчет множителя к матрице шума из процента энергии.
   4. К свертке прибавляется произведение шум с матрицей шума.
5. Восстановление изображения с помощью итерационного алгоритма. Расчет параметра восстановления.
   1. Шаг 1. Выполнить прямое ПФ аппаратной функции.
   2. Шаг 2. Выполнить прямое ПФ изображения.
   3. Шаг 3. Производится деление Фурье-образов, где это возможно.
   4. Шаг 4. Выполняется обратное ПФ.
   5. Шаг 5. В восстановленном изображении зануляются отрицательные элементы.
   6. Шаг 6. Выполняется прямое ПФ.
   7. Шаг 7. В точках, где произведено деление, значение Фурье-образа заменяются результатом деления. В остальных точках значения текущих отсчётов Фурье-образа сохраняются.
   8. Шаг 8. Переход к шагу 4.
6. Исследование зависимости параметра восстановления от шума.

<h2 align="left"> 3. Структура программы - классы и их описание </h2>

1. main.py - запускает окно программы класса GuiProgram.
2. gui_logic.py - class GuiProgram(Ui_Dialog) - контроллер интерфейса - обрабатывает нажатия и ошибки, вызывает функции обработки.
   1. Содержит объект интерфейса, наследник Ui_Dialog.
   2. Содержит объекты графики Graph.
3. gui.ui -> gui.py - class Ui_Dialog(object) - класс диалога и объектов на нем. Автоматически сгенерирован Qt Designer.
4. graph.py - class Graph - на объектах ui (widget и его layout) создает объекты matplotlib (axis, figure, canvas, toolbar) для отображения данных через методы класса Drawer.
5. drawer.py - class Drawer - на объектах Graph строит графики через статичные методы.
6. FastFourierTransform.py - FFT - предоставляет методы для вычислений Фурье преобразований 1d или 2d.
